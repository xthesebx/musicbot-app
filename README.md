DONT LOOK AT CODE ITS UGLY
but it works for now, will fix it someday
